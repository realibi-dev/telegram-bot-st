'use strict';

const { spawnSync } = require('child_process');

const args = ['install', '--fallback-to-build=false'];
if (process.platform == "linux") {
    let regex = /^(\d+)\./;
    let match = process.versions.openssl.match(regex);
    let major = match ? match[1] : null;
    if (major == '1') {
        args.push('--toolset=-legacy');
    }
}

let { status } = spawnSync('node-pre-gyp', args, {
    shell: true,
    stdio: 'inherit'
});

if (status) {
    process.exit(1);
}